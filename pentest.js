// Normal socket.io initalisation, and variables declaration
var socket = io();
var nameCl="blanked", classCl="", answerCl="blanked", total="", teacherClassCl="", r=0, c=0, l="";


//And the command are received by students.

socket.on('classid', function(classKey){
  classCl = classKey;
});

socket.on('systemCommander', function(systemCommand){
  if (classCl == $('#channel').val()){
    switch(systemCommand){
      case 'clozeOpen':
        $('#cloze').show();
        //$('#questionPopup').removeClass('alert-success').addClass('alert-danger');
      break;
      case 'answerClose':
        $('#cloze').hide();
        //$('#questionPopup').removeClass('alert-danger').addClass('alert-success');
      break;
    }
  }
});

socket.on('questionName', function(questionName){
  if (classCl == $('#channel').val()){
    $('#questionPopup').text(questionName);
  }
});

//Now it's all about student's submission.
$('#clozeForm').submit(function(){
  l = $('clozeField').val();
  c = Number(l);
  while(r<c){
    socket.emit('name', r);
    socket.emit('classid', $('#channel').val());
    socket.emit('answer', r);
    r++;
  }
  r=0

  return false;
});

//Where the data are sent via socket
socket.on('name', function(nameKey){
  nameCl = nameKey;
});
